<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Access Control Cheat Sheet</title>
  <link rel="stylesheet" href="/static/style.css">

</head>
<body>
<header id="title-block-header">
</header>
<h1 id="access-control">Access Control</h1>
<h2 id="summary">Summary</h2>
<ul>
<li><a href="#recon">General Recon For Access Control
Vulnerabilities</a></li>
<li><a href="#cheat-sheet">Portswigger Labs Cheat Sheet /
Payloads</a></li>
</ul>
<p><br></p>
<h2 id="resources">Resources</h2>
<ul>
<li>https://portswigger.net/web-security/access-control</li>
<li>https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html</li>
<li>https://owasp.org/www-community/Access_Control</li>
<li>https://owasp.org/www-community/Broken_Access_Control</li>
<li>https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/05-Authorization_Testing/README</li>
</ul>
<p><br></p>
<h2 id="recon">Recon</h2>
<ul>
<li><p>Map out the application and review the results of the mapping
exercises</p></li>
<li><p>We need to understand what are the application’s requirements for
Access Controls:</p>
<ul>
<li>Are there different levels of users in the application?</li>
<li>Are users only given access to a subset of data belonging to
them?</li>
<li>Is there administrative functionality that can be accessed through
the application?</li>
<li>Are there any identifiers that may be used to determine a user’s
access? (Example: ?admin=yes)</li>
</ul></li>
<li><p>If there is only 1 type of User Role on the application. Then we
may not encounter Vertical Privilege Escalation, however, we may still
discover Horizontal Privilege Escalation.</p>
<ul>
<li><p>For example, a query parameter is used to determine which address
to send your purchased items to ( ?addressId=7232 ). The address is
displayed on the screen for confirmation.</p></li>
<li><p>Is it possible to view other user’s addresses by changing the
value of the parameter?</p></li>
</ul></li>
</ul>
<p><br></p>
<h3 id="testing-with-different-user-account">Testing with Different User
Account:</h3>
<ul>
<li><p>If you have access to a normal user &amp; admin user. Walk
through the entire functionality that the higher privileged user can
access, then attempt to access that functionality with the lower
privileged user. This requires strict comparison, functionality that
both users should have access to is not Vertical Privilege
Escalation.</p>
<ul>
<li>We can use Burp’s <a
href="https://medium.com/@chris-m0/how-to-use-burp-suites-compare-site-maps-function-799f5b742dfc">“compare
site maps”</a> feature to help.</li>
</ul></li>
<li><p>If you have access to 2 accounts of the same privilege level,
identify if Horizontal Privilege Escalation is possible.</p></li>
</ul>
<p><br></p>
<h3 id="testing-multistage-processes">Testing Multistage Processes:</h3>
<ul>
<li><p>Burp’s “compare site maps” feature will not work here, because
the requests sent may be out of order from the standard process. This
can lead to false positives/negatives.</p></li>
<li><p>A way to perform this testing is to walk through a protected
multistage process and use Burp Suite to access each one of those
requests by a lower privileged user. Sometimes the initial request in
the process is protected but the subsequent requests are not protected
from unauthorized access.</p></li>
</ul>
<p><br></p>
<h3 id="testing-with-limited-access">Testing with Limited Access:</h3>
<ul>
<li><p>If you only have 1 account to test with or no accounts at all, we
can map out the application to identify any hidden sensitive/protected
functionality.</p></li>
<li><p>When pages are identified that may return different data
depending on the user, try adding parameters/cookies such as,
admin=true, debug=true, etc.</p></li>
<li><p>Identify functionality where the application grants a user access
to a subset of wider resources, such as emails, orders, documents, etc.
If these resources are retrieved through some predictable identifiers (
?order=1234 ) try to determine values that reference other resources, we
should not have access to and attempt to view the data.</p></li>
</ul>
<p><br></p>
<h3 id="testing-restrictions-on-http-methods">Testing Restrictions on
HTTP Methods:</h3>
<ul>
<li><p>An application’s access controls may be bypassed by platform
level controls.</p></li>
<li><p>If there is a protected functionality that only a higher-level
privilege user can access, test whether this functionality can be
accessed with a different HTTP method. Then determine if a lower-level
privilege user can bypass access controls using this method.</p></li>
</ul>
<p><br></p>
<p><br></p>
<h2 id="cheat-sheet">Cheat Sheet</h2>
<h3 id="robots">ROBOTS</h3>
<ul>
<li>Go to the /robots.txt page on the application and see if it reveals
any sensitive locations on the application. We can potentially use these
disclosed endpoints to perform actions that we should not be authorized
to do.</li>
</ul>
<p><br></p>
<h3 id="source-code-leak">Source Code Leak</h3>
<ul>
<li><p>Look through the source code of every page, there may be a
client-side script or comments that discloses sensitive functionality or
data.</p></li>
<li><p>This information can further be used to probe the application for
additional vulnerabilities.</p></li>
</ul>
<p><br></p>
<h3 id="sensitive-cookie">Sensitive Cookie</h3>
<ul>
<li><p>Identify if there are clients-side Cookies that are being used to
enforce your level of access on the application. Change the value and
analyze how the application responds.</p></li>
<li><p>For example, a Cookie named Admin=false, change it to
Admin=true.</p></li>
</ul>
<p><br></p>
<h3 id="mass-assignment">Mass Assignment</h3>
<ul>
<li><p>Identify if the application is vulnerable to a Mass Assignment
vulnerability.</p></li>
<li><p>For example, when updating your email address on the application,
the response discloses a critical parameter called “roleID”. Submit
another request to update your email address, but this time also include
the parameter “roleID” with a different value. Analyze how the
application responds, maybe this can bypass some access
controls.</p></li>
</ul>
<p><br></p>
<h3 id="http-header-bypass---url-based-access-control">HTTP Header
Bypass - URL Based Access Control</h3>
<ul>
<li><p>Use non-standard headers to potentially bypass access control
restrictions on endpoints.</p></li>
<li><p>For example, the following header can be used to access the admin
interface on the application:</p>
<ul>
<li><p>GET /?username=carlos</p></li>
<li><p>X-Original-URL: /admin/delete</p></li>
</ul></li>
</ul>
<p><br></p>
<h3 id="http-method-bypass">HTTP Method Bypass</h3>
<ul>
<li><p>Use different HTTP methods when requesting a resource. This may
bypass the access controls implemented on the endpoint.</p></li>
<li><p>For example, use GET/PUT instead of POST.</p></li>
</ul>
<p><br></p>
<h3 id="idor">IDOR</h3>
<ul>
<li><p>IDOR vulnerability allowed us to specify a different resource
belonging to another user by manipulating a query parameter.</p></li>
<li><p>Always look into the source code of the application to identify
if there is any sensitive data leakage.</p></li>
<li><p>For example, ?id=user123, change it to ?id=user456</p></li>
</ul>
<p><br></p>
<h3 id="idor-1">IDOR</h3>
<ul>
<li>IDOR vulnerability allowed us to view another user’s account
information. This time the parameter value was unpredictable, however,
there was some functionality on the application which exposed other
user’s GUID value. Which can be used to view their account information
in an endpoint like ?id=xxxx-xxxx…</li>
</ul>
<p><br></p>
<h3 id="redirect-leakage">Redirect Leakage</h3>
<ul>
<li>When submitting an invalid account on the following endpoint
“/my-account?id=xxx” we receive a 302 HTTP response with no body. If we
submit a valid account on the endpoint, we still receive a 302 HTTP
response, but the response body is disclosing sensitive information for
the specified user.</li>
</ul>
<p><br></p>
<h3 id="idor-2">IDOR</h3>
<ul>
<li>If there is a endpoint similar to this one -&gt; /download/2.txt,
change the file to -&gt; /download/1.txt, this may disclose valuable
information that may belong to other users on the application.</li>
</ul>
<p><br></p>
<h3 id="multi-step-bypass">Multi-step Bypass</h3>
<ul>
<li>When testing a multi-step process with an admin account, test to see
if a lower privilege user can bypass the access controls on any of those
steps individually.<br />
</li>
<li>If it is a 3-step process, the first 2 steps may be properly
protected, but the last step may be left unsecured.</li>
</ul>
<p><br></p>
<h3 id="referer-header-bypass">Referer Header Bypass</h3>
<ul>
<li><p>The Referer header may be used to prevent unauthorized access to
certain endpoints on the application. If we can figure out what the
required value is, we may be able to bypass this restriction.</p></li>
<li><p>For example:</p>
<ul>
<li>GET /admin?delete?user=xxx</li>
<li>Referer: https://vulnerable-app.com/admin</li>
</ul></li>
</ul>
<p><br><br></p>
<h3
id="pending-to-complete-labs-that-are-missing-from-cheat-sheet">Pending
to complete labs that are missing from cheat sheet:</h3>
<ul>
<li>All labs in this category are completed and referenced in cheat
sheet.</li>
</ul>
</body>
</html>
